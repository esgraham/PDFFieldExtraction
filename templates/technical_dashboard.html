<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - PDF Field Extraction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <i class="fas fa-file-pdf me-2"></i>PDF Field Extraction Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home me-1"></i>Overview</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard/executive"><i class="fas fa-chart-line me-1"></i>Executive</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard/operational"><i class="fas fa-cogs me-1"></i>Operational</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/dashboard/technical"><i class="fas fa-server me-1"></i>Technical</a>
                    </li>
                </ul>
                <div class="d-flex">
                    <button class="btn btn-sm btn-outline-light me-2" id="exportBtn">
                        <i class="fas fa-download me-1"></i>Export Data
                    </button>
                    <button class="btn btn-sm btn-outline-light" id="debugModeBtn">
                        <i class="fas fa-bug me-1"></i>Debug Mode
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- System Health Overview -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card border-success">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><i class="fas fa-server me-2"></i>Technical Performance Report</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>System Health</h6>
                                        <div class="health-indicator">
                                            <div class="d-flex justify-content-between">
                                                <span>CPU Usage:</span>
                                                <strong id="cpuUsage">--</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Memory Usage:</span>
                                                <strong id="memoryUsage">--</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Disk I/O:</span>
                                                <strong id="diskIO">--</strong>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Performance Metrics</h6>
                                        <div class="performance-metrics">
                                            <div class="d-flex justify-content-between">
                                                <span>Requests/sec:</span>
                                                <strong id="requestsPerSec">--</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Avg Response Time:</span>
                                                <strong id="avgResponseTime">--</strong>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>Error Rate:</span>
                                                <strong id="systemErrorRate">--</strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="text-center">
                                    <canvas id="systemHealthChart" height="150"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Latency Distribution -->
        <div class="row mb-4">
            <div class="col-lg-8 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-clock me-2"></i>Latency Distribution Analysis</h6>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-3 text-center">
                                <h4 class="text-info mb-0" id="latencyP50">--</h4>
                                <small class="text-muted">P50 (Median)</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <h4 class="text-warning mb-0" id="latencyP90">--</h4>
                                <small class="text-muted">P90</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <h4 class="text-danger mb-0" id="latencyP95">--</h4>
                                <small class="text-muted">P95</small>
                            </div>
                            <div class="col-md-3 text-center">
                                <h4 class="text-dark mb-0" id="latencyP99">--</h4>
                                <small class="text-muted">P99</small>
                            </div>
                        </div>
                        <canvas id="latencyDistributionChart" height="250"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-microchip me-2"></i>Component Performance</h6>
                    </div>
                    <div class="card-body">
                        <div class="component-metrics">
                            <div class="component-item">
                                <strong>OCR Engine:</strong>
                                <div class="progress mb-1">
                                    <div class="progress-bar bg-success" id="ocrPerformance" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="ocrTime">Avg: --ms</small>
                            </div>
                            <div class="component-item">
                                <strong>Field Extraction:</strong>
                                <div class="progress mb-1">
                                    <div class="progress-bar bg-info" id="extractionPerformance" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="extractionTime">Avg: --ms</small>
                            </div>
                            <div class="component-item">
                                <strong>Validation:</strong>
                                <div class="progress mb-1">
                                    <div class="progress-bar bg-warning" id="validationPerformance" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="validationTime">Avg: --ms</small>
                            </div>
                            <div class="component-item">
                                <strong>Database I/O:</strong>
                                <div class="progress mb-1">
                                    <div class="progress-bar bg-primary" id="dbPerformance" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="dbTime">Avg: --ms</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Field-Level Performance -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-table me-2"></i>Field-Level Performance Metrics</h6>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover" id="fieldMetricsTable">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Field Name</th>
                                        <th>Document Type</th>
                                        <th>Precision</th>
                                        <th>Recall</th>
                                        <th>F1 Score</th>
                                        <th>Accuracy</th>
                                        <th>Avg Confidence</th>
                                        <th>Total Predictions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="8" class="text-center text-muted">Loading field metrics...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Exception Breakdown & Document Type Analysis -->
        <div class="row mb-4">
            <div class="col-lg-6 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-bug me-2"></i>Exception Breakdown (JSON)</h6>
                    </div>
                    <div class="card-body">
                        <pre><code id="exceptionBreakdownJSON" class="json-code">Loading exception data...</code></pre>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-file-alt me-2"></i>Document Type Analysis</h6>
                    </div>
                    <div class="card-body">
                        <div id="documentTypeAnalysis">
                            <div class="text-center text-muted">Loading document type analysis...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cost Analysis & Resource Utilization -->
        <div class="row mb-4">
            <div class="col-lg-8 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-calculator me-2"></i>Detailed Cost Analysis</h6>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Component</th>
                                        <th>Cost/Document</th>
                                        <th>Utilization</th>
                                        <th>Optimization Potential</th>
                                        <th>Recommendation</th>
                                    </tr>
                                </thead>
                                <tbody id="costAnalysisTable">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">Loading cost analysis...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-3">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Resource Usage</h6>
                    </div>
                    <div class="card-body">
                        <canvas id="resourceUsageChart" height="200"></canvas>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>Peak Usage:</strong> <span id="peakUsage">--</span><br>
                                <strong>Off-Peak:</strong> <span id="offPeakUsage">--</span><br>
                                <strong>Efficiency Score:</strong> <span id="efficiencyScore">--</span>
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Logs & Debug Information -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h6 class="mb-0"><i class="fas fa-list-alt me-2"></i>System Logs & Debug Information</h6>
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary" id="filterErrors">Errors</button>
                            <button class="btn btn-outline-warning" id="filterWarnings">Warnings</button>
                            <button class="btn btn-outline-info" id="filterInfo">Info</button>
                            <button class="btn btn-outline-secondary" id="clearLogs">Clear</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="log-container" id="systemLogs">
                            <div class="text-center text-muted">Loading system logs...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Raw Data Export Modal -->
        <div class="modal fade" id="exportModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-download me-2"></i>Export Technical Data
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Data Format:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="exportFormat" id="jsonFormat" value="json" checked>
                                    <label class="form-check-label" for="jsonFormat">JSON</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="exportFormat" id="csvFormat" value="csv">
                                    <label class="form-check-label" for="csvFormat">CSV</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="exportFormat" id="xmlFormat" value="xml">
                                    <label class="form-check-label" for="xmlFormat">XML</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Data Type:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="exportMetrics" checked>
                                    <label class="form-check-label" for="exportMetrics">Performance Metrics</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="exportLogs" checked>
                                    <label class="form-check-label" for="exportLogs">System Logs</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="exportExceptions">
                                    <label class="form-check-label" for="exportExceptions">Exception Data</label>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <label for="dateRange" class="form-label">Date Range:</label>
                            <select class="form-select" id="dateRange">
                                <option value="1">Last 24 hours</option>
                                <option value="7" selected>Last 7 days</option>
                                <option value="30">Last 30 days</option>
                                <option value="custom">Custom range</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="downloadBtn">
                            <i class="fas fa-download me-1"></i>Download
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/technical-dashboard.js"></script>
</body>
</html>